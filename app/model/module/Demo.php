<?php

namespace Pit\BigQuery\Model;

class Demo extends Bseg
{
    
    public function subtotal($params){

    }

    public function breakdown($params){

       $sql = 

       "SELECT ROUND(CAST(DMBTR AS FLOAT64), 2) AS Monto, SGTXT AS Descripcion, '2019' AS Anualidad, 'BANCO' AS Modulo, '6410010104' AS Cuenta, 2 AS Id, '3' AS Mes, SUBSTR(BUDAT,7,8) AS Dia, '1' AS Pagado, '0' AS Editable FROM (SELECT BUDAT, KOSTL, HKONT, DMBTR, SGTXT FROM `informe-211921.BALANZA.BSEG_2019_3` WHERE CAST(SUBSTR(BUDAT,5,2) AS INT64) = 3 AND CAST(SUBSTR(BUDAT,1,4) AS INT64) = 2019 AND KOSTL IN ('5000200102','5000300101','5010000100','5020100100','5020100101','5020100102','5020100103','5020100104','5020100106','5020100107','5020100108','5020100109','5020100110','5020100111','5020100112','5020100113','5020100114','5020100115','5020100116','5020100117','5020100118','5020100120','5020100121','5020100201','5020100202','5020100204','5020100205','5020100206','5020100300','5020100301','5020100302','5020100303','5020100304','5020100400','5020100401','5020100402','5020100403','5020100500','5020100501','5020100502','5020100503','5020100504','5020100600','5020100601','5020100602','5020100603','5020100700','5020100701','5020100800','5020100801','5020100802','5020100900','5020100901','5020100902','5020100903','5020100904','5020100905','5020100906','5020101001','5020101101','5020200100','5020200101','5020200102','5020200103','5020200104','5020200105','5020200106','5020200201','5020200301','5020200400','5020200401','5020200601','5020200602','5020200701','5020200801','5020200901','5020300000','5020300101','5020300102','5020300103','5020300202','5020300401','5020300402','5020300701','5020300801','5020400100','5020430100','5020440100','5030100100','5030100101','5030110100','5030120100','5030130100','5030140100','5030150100','5030160100','5030200100','5030200101','5030220100','5030230100','5030240100','5030250100','5030300100','5030500100','5040000100','5040100100','5040200100','5040300100','5040400100','5050000100','5050100100','5050200100','5050300100','5050500100','5050800100','5060000100','5060000101','5060100100','5060200100','5070000000','5070000100','5070100100','5070200100','5070300100','5070400100','5070500100','5070600100','5080100100','5080200100','5090000100','5090100100','5090200100','5090500100','5090700100','5100000100','5100100100','5120000100','5120100100','5120300100','5510000000','5511009310','5517096100','5520100100','5520200100','5530100101','5530100301','5530100400','5530100401','5530100601','5530100801','5530100901','5530101201','5530101301','5530101401','5530101501','5540100100','5540100101','5560100101','5560100301','5560100501','5560100601','5560100701','5560100801','5570100101','5590100100','5590100101','5590100102','5600100100') AND HKONT = '6410010104');";

       $breakdown=$this->bigQueryLib->select($sql);

    }
    
    public function ammount($params){

        $sql = 
        " SELECT HKONT AS account, BUDAT AS ".
        " FROM ".
        " (SELECT BUDAT,DMBTR,HKONT FROM `informe-211921.MULTIVA.BSEGAIO` ".
        " WHERE CAST(SUBSTR(BUDAT,5,2) AS INT64) = 1 ".
        " AND CAST(SUBSTR(BUDAT,1,4) AS INT64) = 2019 ".
        " AND KOSTL IN (SELECT KOSTL FROM `informe-211921.MULTIVA.CECOS` WHERE MODULO = 'OPERADORA')".
        " AND HKONT = '6410010103'); ";
        

    }

}

